<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logout - Omada WiFi</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 50px;
        }
        .container {
            max-width: 500px;
            margin: auto;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 10px;
            box-shadow: 2px 2px 10px rgba(0,0,0,0.1);
        }
         .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 10px;
            margin-top: 10px;
            border-radius: 5px;
            text-decoration: none;
            font-size: 16px;
            font-weight: bold;
            color: white;
            border: none;
            cursor: pointer;
            width: 200px;
            margin: auto;
        }
        .fb-btn {
            background-color: #1877F2;
        }
        .yt-btn {
            background-color: #FF0000;
        }
        .btn img {
            width: 20px;
            height: 20px;
        }

    </style>
</head>
<body>
    <div class="container">
        <h2>Session Details</h2>
        <p><strong>Session Start:</strong> <span id="startDateTime">Loading...</span></p>
        <p><strong>Active Session Duration:</strong> <span id="sessionDuration">00:00:00</span></p>
        <button onclick="logout()">Logout</button>
    </div>
    <div>
        <!-- Facebook Follow Button -->
        <a href="https://www.facebook.com/teamdoyoyofficial" target="_blank" class="btn fb-btn">
            <img src="https://upload.wikimedia.org/wikipedia/commons/6/6f/Facebook_Logo_2023.png" alt="Facebook Logo">
            Follow on Facebook
        </a>
    <div>
        <!-- YouTube Subscribe Button -->
        <a href="https://www.youtube.com/@teamdoyoy?sub_confirmation=1" target="_blank" class="btn yt-btn">
            <img src="https://upload.wikimedia.org/wikipedia/commons/b/b8/YouTube_social_white_squircle_%282017%29.svg" alt="YouTube Logo">
            Subscribe on YouTube
        </a>
    </div>
    <script>
        // Get stored session data
        let startTime = localStorage.getItem("sessionStartTime");
        let activeTime = parseInt(localStorage.getItem("activeSessionTime")) || 0;
        let lastActive = localStorage.getItem("lastActive");

        // If no session exists, start now
        if (!startTime) {
            startTime = new Date().toISOString();
            localStorage.setItem("sessionStartTime", startTime);
        }

        // Convert stored session start time to readable format
        let startDate = new Date(startTime);
        let formattedDate = startDate.toLocaleString(); // Includes date and time
        document.getElementById("startDateTime").innerText = formattedDate;

        let tracking = false;
        let interval;

        // Function to update session duration
        function updateSessionDuration() {
            let duration = activeTime; // Start with previously stored active time

            if (tracking) {
                let now = new Date();
                let lastActiveDate = lastActive ? new Date(lastActive) : now;
                duration += Math.floor((now - lastActiveDate) / 1000); // Add new active time
            }

            let hours = Math.floor(duration / 3600);
            let minutes = Math.floor((duration % 3600) / 60);
            let seconds = duration % 60;

            document.getElementById("sessionDuration").innerText =
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // Start tracking when page is active
        function startTracking() {
            if (!tracking) {
                tracking = true;
                lastActive = new Date().toISOString();
                localStorage.setItem("lastActive", lastActive);
            }
        }

        // Stop tracking when page is inactive
        function stopTracking() {
            if (tracking) {
                tracking = false;
                let now = new Date();
                let lastActiveDate = new Date(lastActive);
                activeTime += Math.floor((now - lastActiveDate) / 1000);
                localStorage.setItem("activeSessionTime", activeTime);
            }
        }

        // Listen for page visibility changes
        document.addEventListener("visibilitychange", () => {
            if (document.visibilityState === "visible") {
                startTracking();
            } else {
                stopTracking();
            }
        });

        // Start tracking on load
        window.onload = function () {
            startTracking();
            interval = setInterval(updateSessionDuration, 1000);
        };

        // Logout function (clears session data)
        function logout() {
            localStorage.removeItem("sessionStartTime");
            localStorage.removeItem("activeSessionTime");
            localStorage.removeItem("lastActive");
            window.location.href = "http://portal.tplink.net/portal/logout"; // Omada logout
        }
    </script>
</body>
</html>
